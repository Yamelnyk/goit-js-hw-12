{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function getImage(query, currentPage) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const params = new URLSearchParams({\n    key: '43183854-3276a6d2cec346ebc07eac88c',\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: 15,\n    page: currentPage,\n  });\n  // const url = `${BASE_URL}?${params}`;\n\n  const res = await axios.get(BASE_URL, { params });\n  return res.data;\n}\n\n// getImage().then(data => console.log(data.hits));\n","// Описаний у документації\n\nexport function imgTemplate(img) {\n  return img\n    .map(image => {\n      return `<div class=\"card\">\n        <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n          </a>\n          <ul class=\"list\">\n            <li class=\"item\">Likes: <span>${image.likes}</span></li>\n            <li class=\"item\">Views: <span>${image.views}</span></li>\n            <li class=\"item\">Comments: <span>${image.comments}</span></li>\n            <li class=\"item\">Downloads: <span>${image.downloads}</span></li>\n          </ul>\n          </div>`;\n    })\n    .join('');\n}\n","import { getImage } from './js/pixabay-api';\nimport { imgTemplate } from './js/render-functions';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst refs = {\n  formEl: document.querySelector('.form'),\n  gallery: document.querySelector('.gallery'),\n  loadElem: document.querySelector('.loader'),\n  btnLoadMore: document.querySelector('.js-btn-load'),\n};\n\nlet query;\nlet currentPage = 1;\nlet maxPage = 0;\nconst pageSize = 14;\n\nrefs.formEl.addEventListener('submit', onFormSubmit);\nrefs.btnLoadMore.addEventListener('click', onLoadMoreClick);\n\nasync function onFormSubmit(e) {\n  e.preventDefault();\n  showLoader();\n\n  query = refs.formEl.elements.searchImages.value.trim();\n  refs.gallery.innerHTML = '';\n  currentPage = 1;\n\n  if (!query.length) {\n    iziToast.error({\n      color: 'yellow',\n      message: ` Please fill in the field for search query.`,\n      position: 'topRight',\n    });\n  }\n\n  try {\n    const data = await getImage(query, currentPage);\n    maxPage = Math.ceil(data.total / pageSize);\n\n    if (!data.hits.length) {\n      iziToast.error({\n        color: 'red',\n        message: `❌ Sorry, there are no images matching your search query. Please try again!`,\n        position: 'topRight',\n      });\n    }\n\n    const markup = imgTemplate(data.hits);\n    refs.gallery.insertAdjacentHTML('beforeend', markup);\n    showLoadMore();\n\n    let simplGallery = new SimpleLightbox('.gallery a');\n    simplGallery.refresh();\n  } catch (err) {\n    console.log(err);\n  }\n\n  hideLoader();\n  checkBtnStatus();\n  refs.formEl.reset();\n}\n\nasync function onLoadMoreClick() {\n  showLoader();\n  currentPage += 1;\n  const data = await getImage(query, currentPage);\n\n  const markup = imgTemplate(data.hits);\n\n  refs.gallery.insertAdjacentHTML('beforeend', markup);\n\n  const rect = refs.gallery.firstElementChild.getBoundingClientRect().height;\n  window.scrollBy({\n    top: rect * 2,\n  });\n  hideLoader();\n  checkBtnStatus();\n}\n\nfunction checkBtnStatus() {\n  if (currentPage >= maxPage) {\n    hideLoadMore();\n    iziToast.show({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'topRight',\n    });\n  } else {\n    showLoadMore();\n  }\n}\n\nfunction showLoadMore() {\n  refs.btnLoadMore.classList.remove('hidden');\n}\n\nfunction hideLoadMore() {\n  refs.btnLoadMore.classList.add('hidden');\n}\n\nfunction showLoader() {\n  refs.loadElem.classList.remove('hidden');\n}\n\nfunction hideLoader() {\n  refs.loadElem.classList.add('hidden');\n}\n"],"names":["getImage","query","currentPage","BASE_URL","params","axios","imgTemplate","img","image","refs","maxPage","pageSize","onFormSubmit","onLoadMoreClick","e","showLoader","iziToast","data","markup","showLoadMore","SimpleLightbox","err","hideLoader","checkBtnStatus","rect","hideLoadMore"],"mappings":"owBAEO,eAAeA,EAASC,EAAOC,EAAa,CACjD,MAAMC,EAAW,2BACXC,EAAS,IAAI,gBAAgB,CACjC,IAAK,qCACL,EAAGH,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,SAAU,GACV,KAAMC,CACV,CAAG,EAID,OADY,MAAMG,EAAM,IAAIF,EAAU,CAAE,OAAAC,CAAM,CAAE,GACrC,IACb,CCfO,SAASE,EAAYC,EAAK,CAC/B,OAAOA,EACJ,IAAIC,GACI;AAAA,wCAC2BA,EAAM,aAAa;AAAA,8CACbA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA,4CAGxCA,EAAM,KAAK;AAAA,4CACXA,EAAM,KAAK;AAAA,+CACRA,EAAM,QAAQ;AAAA,gDACbA,EAAM,SAAS;AAAA;AAAA,iBAG1D,EACA,KAAK,EAAE,CACZ,CCTA,MAAMC,EAAO,CACX,OAAQ,SAAS,cAAc,OAAO,EACtC,QAAS,SAAS,cAAc,UAAU,EAC1C,SAAU,SAAS,cAAc,SAAS,EAC1C,YAAa,SAAS,cAAc,cAAc,CACpD,EAEA,IAAIR,EACAC,EAAc,EACdQ,EAAU,EACd,MAAMC,EAAW,GAEjBF,EAAK,OAAO,iBAAiB,SAAUG,CAAY,EACnDH,EAAK,YAAY,iBAAiB,QAASI,CAAe,EAE1D,eAAeD,EAAaE,EAAG,CAC7BA,EAAE,eAAc,EAChBC,IAEAd,EAAQQ,EAAK,OAAO,SAAS,aAAa,MAAM,OAChDA,EAAK,QAAQ,UAAY,GACzBP,EAAc,EAETD,EAAM,QACTe,EAAS,MAAM,CACb,MAAO,SACP,QAAS,8CACT,SAAU,UAChB,CAAK,EAGH,GAAI,CACF,MAAMC,EAAO,MAAMjB,EAASC,EAAOC,CAAW,EAC9CQ,EAAU,KAAK,KAAKO,EAAK,MAAQN,CAAQ,EAEpCM,EAAK,KAAK,QACbD,EAAS,MAAM,CACb,MAAO,MACP,QAAS,6EACT,SAAU,UAClB,CAAO,EAGH,MAAME,EAASZ,EAAYW,EAAK,IAAI,EACpCR,EAAK,QAAQ,mBAAmB,YAAaS,CAAM,EACnDC,IAEmB,IAAIC,EAAe,YAAY,EACrC,QAAO,CACrB,OAAQC,EAAK,CACZ,QAAQ,IAAIA,CAAG,CAChB,CAEDC,IACAC,IACAd,EAAK,OAAO,OACd,CAEA,eAAeI,GAAkB,CAC/BE,IACAb,GAAe,EACf,MAAMe,EAAO,MAAMjB,EAASC,EAAOC,CAAW,EAExCgB,EAASZ,EAAYW,EAAK,IAAI,EAEpCR,EAAK,QAAQ,mBAAmB,YAAaS,CAAM,EAEnD,MAAMM,EAAOf,EAAK,QAAQ,kBAAkB,sBAAuB,EAAC,OACpE,OAAO,SAAS,CACd,IAAKe,EAAO,CAChB,CAAG,EACDF,IACAC,GACF,CAEA,SAASA,GAAiB,CACpBrB,GAAeQ,GACjBe,IACAT,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,UAChB,CAAK,GAEDG,GAEJ,CAEA,SAASA,GAAe,CACtBV,EAAK,YAAY,UAAU,OAAO,QAAQ,CAC5C,CAEA,SAASgB,GAAe,CACtBhB,EAAK,YAAY,UAAU,IAAI,QAAQ,CACzC,CAEA,SAASM,GAAa,CACpBN,EAAK,SAAS,UAAU,OAAO,QAAQ,CACzC,CAEA,SAASa,GAAa,CACpBb,EAAK,SAAS,UAAU,IAAI,QAAQ,CACtC"}